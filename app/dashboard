'use client';

import { useState, useEffect } from 'react';
import {
  LineChart,
  Line,
  XAxis,
  YAxis,
  CartesianGrid,
  Tooltip,
  ResponsiveContainer
} from 'recharts';

const mockHistory = [
  { date: '2024-05-01', level: 'L1' },
  { date: '2024-05-03', level: 'L2' },
  { date: '2024-05-07', level: 'L3' },
  { date: '2024-05-12', level: 'L3' },
  { date: '2024-05-15', level: 'L4' }
];

const levelLabelMap: Record<string, string> = {
  L1: 'ç›´è¦ºè¼¸å…¥è€…',
  L2: 'çµæ§‹ä½¿ç”¨è€…',
  L3: 'èªè¨€å°æ¼”',
  L4: 'Metaé§•é§›è€…',
  L5: 'èªè¨€æ¶æ§‹å¸«'
};

const levelColor: Record<string, string> = {
  L1: 'bg-gray-400',
  L2: 'bg-blue-400',
  L3: 'bg-green-500',
  L4: 'bg-yellow-500',
  L5: 'bg-purple-600'
};

const levelNumericMap: Record<string, number> = {
  L1: 1,
  L2: 2,
  L3: 3,
  L4: 4,
  L5: 5
};

export default function DashboardPage() {
  const [history, setHistory] = useState(mockHistory);

  useEffect(() => {
    // å¯æ¥å¾Œç«¯æˆ– localStorage è³‡æ–™
  }, []);

  const chartData = history.map((entry) => ({
    date: entry.date,
    level: levelNumericMap[entry.level]
  }));

  return (
    <div className="max-w-4xl mx-auto px-6 py-10">
      <h1 className="text-3xl font-bold mb-6 text-center">ä½ çš„èªè¨€æˆé•·å„€è¡¨æ¿</h1>

      <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-10">
        {history.map((entry, idx) => (
          <div
            key={idx}
            className={`rounded-lg p-4 text-white ${levelColor[entry.level]}`}
          >
            <p className="text-sm mb-1">{entry.date}</p>
            <p className="text-lg font-semibold">{entry.level}ï½œ{levelLabelMap[entry.level]}</p>
          </div>
        ))}
      </div>

      <h2 className="text-xl font-semibold text-center mb-4">ğŸ“ˆ èªè¨€éšå±¤æ›²ç·šåœ–</h2>
      <div className="w-full h-72">
        <ResponsiveContainer width="100%" height="100%">
          <LineChart data={chartData} margin={{ top: 5, right: 20, bottom: 5, left: 0 }}>
            <CartesianGrid strokeDasharray="3 3" />
            <XAxis dataKey="date" />
            <YAxis domain={[1, 5]} ticks={[1, 2, 3, 4, 5]} allowDecimals={false} tickFormatter={(val) => `L${val}`} />
            <Tooltip formatter={(val: any) => `L${val}`} />
            <Line type="monotone" dataKey="level" stroke="#6366f1" strokeWidth={2} dot={{ r: 4 }} />
          </LineChart>
        </ResponsiveContainer>
      </div>

      <p className="text-center text-gray-500 text-sm mt-6">
        ğŸ“Š æ­¤åœ–é¡¯ç¤ºä½ è¿‘æœŸçš„èªè¨€éšå±¤è®ŠåŒ–ï¼Œè¶Šé«˜ä»£è¡¨è¶Šæ¥è¿‘æ¨¡çµ„è¨­è¨ˆè€…ã€‚
      </p>
    </div>
  );
}
